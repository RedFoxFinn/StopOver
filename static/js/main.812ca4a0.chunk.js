(this.webpackJsonpstopover=this.webpackJsonpstopover||[]).push([[0],{190:function(t,e,n){"use strict";n.r(e);var o,i,a,r,c,l=n(0),s=n.n(l),d=n(46),u=n.n(d),m=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,262)).then((function(e){var n=e.getCLS,o=e.getFID,i=e.getFCP,a=e.getLCP,r=e.getTTFB;n(t),o(t),i(t),a(t),r(t)}))},b=n(244),j=n(29),p=n(47),v=Object(p.b)({name:"location_start",initialState:{street:"",number:"",municipality:"",geocode:null},reducers:{setStreet:function(t,e){t.street=e.street},setNumber:function(t,e){t.number=e.number},setMunicipality:function(t,e){t.municipality=e.municipality},resetAddress:function(t,e){t.street="",t.number="",t.municipality=""},setGeocode:function(t,e){t.geocode=e.geocode},resetStart:function(t,e){t.street="",t.number="",t.municipality="",t.geocode=null}}}),f=v.actions,g=(f.setStreet,f.setNumber,f.setMunicipality,f.setGeocode,f.resetAddress,f.resetStart,v.reducer),O=Object(p.b)({name:"location_end",initialState:{street:"",number:"",municipality:"",geocode:null},reducers:{setStreet:function(t,e){t.street=e.street},setNumber:function(t,e){t.number=e.number},setMunicipality:function(t,e){t.municipality=e.municipality},resetAddress:function(t,e){t.street="",t.number="",t.municipality=""},setGeocode:function(t,e){t.geocode=e.geocode},resetEnd:function(t,e){t.street="",t.number="",t.municipality="",t.geocode=null}}}),h=O.actions,y=(h.setStreet,h.setNumber,h.setMunicipality,h.setGeocode,h.resetAddress,h.resetEnd,O.reducer),x=Object(p.b)({name:"notification_control",initialState:{alert:null},reducers:{setAlert:function(t,e){t.alert=e.alert},resetAlert:function(t,e){t.alert=null}}}),S=x.actions,I=(S.setAlert,S.resetAlert,x.reducer),_=n(24),k=Object(p.b)({name:"route_control",initialState:{routes:[],defaultroute:null},reducers:{setRoutes:function(t,e){t.routes=e.routes},resetRoutes:function(t,e){t.routes=[]},addRoute:function(t,e){t.routes.length>0?t.routes=[].concat(Object(_.a)(t.routes),[e.route]):t.routes=[e.route]},setDefault:function(t,e){t.defaultroute=e.route},resetDefault:function(t,e){t.defaultroute=null}}}),w=k.actions,A=(w.setRoutes,w.resetRoutes,w.addRoute,w.setDefault,w.resetDefault,k.reducer),D=Object(p.a)({reducer:{start:g,end:y,notification:I,route:A}}),P=n(246),$=n(247),C=new P.a({uri:"https://api.digitransit.fi/routing/v1/routers/hsl/index/graphql",cache:new $.a}),R=n(54),T=n(254),L=n(253),N=n(251),M=n(256),z=n(257),B=n(141),E=n.n(B),F=n(74),q=n(142),G=n(66),J=n(67),V=n(135),W=n(23),H=n(259),U=n(16),K=n(136),Q=n(250),X=n(32),Y=n(249),Z=Object(Y.a)(o||(o=Object(X.a)(["\n  fragment StoptimeDetails on Stoptime {\n    serviceDay\n    scheduledDeparture\n    departureDelay\n    realtime\n    trip {\n      routeShortName\n      tripHeadsign\n    }\n  }\n"]))),tt=Object(Y.a)(i||(i=Object(X.a)(["\n  fragment StopDetails on Stop {\n    code\n    name\n    gtfsId\n    zoneId\n    vehicleMode\n    stopTimesForPatterns(omitNonPickups: true, timeRange: 1800) {\n      stopTimes {\n        ...StoptimeDetails\n      }\n    }\n  }\n  ","\n"])),Z),et=Object(Y.a)(a||(a=Object(X.a)(["\n  fragment LegDetails on Leg {\n    mode\n    startTime\n    endTime\n    from {\n      lat\n      lon\n      name\n      stop {\n        ...StopDetails\n      }\n    }\n  }\n  ","\n"])),tt),nt=Object(Y.a)(r||(r=Object(X.a)(["\n  fragment ItineraryDetails on Itinerary {\n    walkDistance\n    duration\n    legs {\n      ...LegDetails\n    }\n  }\n  ","\n"])),et),ot=(n.p,Object(Y.a)(c||(c=Object(X.a)(["\n  query plan(\n      $fromPlace: String!,\n      $toPlace: String!,\n      $numItineraries: Int,\n      $walkSpeed: Float,\n      $walkReluctance: Float,\n      $walkBoardCost: Int,\n      $minTransferTime: Int,\n      $date: String,\n      $time: String,\n      $transportModes: [TransportMode]\n  ) {\n    plan(\n      fromPlace: $fromPlace,\n      toPlace: $toPlace,\n      numItineraries: $numItineraries,\n      walkSpeed: $walkSpeed,\n      walkReluctance: $walkReluctance,\n      walkBoardCost: $walkBoardCost,\n      minTransferTime: $minTransferTime,\n      date: $date,\n      time: $time,\n      transportModes: $transportModes\n    ) {\n      ...ItineraryDetails\n    }\n  }\n  ","\n"])),nt)),it=n(2),at=function(t){Object(K.a)(t);var e=Object(Q.a)(ot,{}),n=Object(U.a)(e,2),o=(n[0],n[1]),i=o.called,a=o.data,r=o.error,c=o.loading;return Object(it.jsxs)("section",{id:t.id,"data-testid":t.id,children:[i&&c&&Object(it.jsx)("p",{children:"Itinerary loading"}),i&&r&&Object(it.jsx)("p",{children:"Itinerary loading failed"}),i&&a&&Object(it.jsx)("p",{children:"Itinerary loaded"}),!i&&Object(it.jsx)("p",{children:"Itinerary loading not initialized"})]})},rt=n(6),ct=n(260),lt=n(245),st=n(114),dt=n.n(st),ut=n(139),mt=n.n(ut),bt=n(255),jt=n(138),pt=function(){return"".concat("https://nominatim.openstreetmap.org/search?addressdetails=1&")},vt=function(t,e,n){return"street=".concat(e,"%20").concat(t,"&city=").concat(n,"&limit=2&format=json")},ft=n.n(jt).a.create({baseUrl:pt()}),gt=function(t){var e,n=t.end,o=void 0!==n&&n,i=t.start,a=void 0!==i&&i,r=t.id,c=void 0===r?"default":r,l=o?Object(j.c)((function(t){return t.end})):a?Object(j.c)((function(t){return t.start})):null,s=Object(j.b)(),d=function(){document.getElementById("".concat(c,"-street")).value="",document.getElementById("".concat(c,"-number")).value="",document.getElementById("".concat(c,"-municipality")).value=""};return o||a?Object(it.jsxs)(ct.a,(e={id:c,"data-testid":c,component:"form",variant:"outlined",sx:{"& > :not(style)":{m:1},minWidth:300,maxWidth:800,marginBottom:2,backgroundColor:"rgba(0,0,0,0.05)"},noValidate:!0,autoComplete:"off"},Object(rt.a)(e,"id",c),Object(rt.a)(e,"children",[o?Object(it.jsx)(H.a,{children:Object(it.jsx)(bt.a,{icon:Object(it.jsx)(dt.a,{}),label:"P\xe4\xe4tepiste",color:"info",variant:"outlined"})}):a?Object(it.jsx)(H.a,{children:Object(it.jsx)(bt.a,{icon:Object(it.jsx)(dt.a,{}),label:"L\xe4ht\xf6piste",color:"info",variant:"outlined"})}):null,Object(it.jsx)(lt.a,{id:"".concat(c,"-street"),"data-testid":"".concat(c,"-street"),InputLabelProps:{shrink:!0},label:"katu",defaultValue:"",size:"small",onChange:function(t){o?s({type:"location_end/setStreet",street:t.target.value}):a?s({type:"location_start/setStreet",street:t.target.value}):console.log("input not set to either end or start")},color:"primary"},"".concat(c,"-street")),Object(it.jsx)(lt.a,{id:"".concat(c,"-number"),"data-testid":"".concat(c,"-number"),InputLabelProps:{shrink:!0},label:"numero",defaultValue:"",size:"small",onChange:function(t){o?s({type:"location_end/setNumber",number:t.target.value}):a?s({type:"location_start/setNumber",number:t.target.value}):console.log("input not set to either end or start")},sx:{maxWidth:80},color:"primary"},"".concat(c,"-number")),Object(it.jsx)(lt.a,{id:"".concat(c,"-municipality"),"data-testid":"".concat(c,"-municipality"),InputLabelProps:{shrink:!0},label:"kunta",defaultValue:"",size:"small",onChange:function(t){o?s({type:"location_end/setMunicipality",municipality:t.target.value}):a?s({type:"location_start/setMunicipality",municipality:t.target.value}):console.log("input not set to either end or start")},color:"primary"},"".concat(c,"-municipality")),Object(it.jsx)(M.a,{id:"".concat(c,"-query"),"data-testid":"".concat(c,"-query"),variant:"outlined",size:"medium",color:"secondary",onClick:function(){var t=null!==l&&void 0!==l?l:null,e=t.street,n=t.number,i=t.municipality;a&&ft.get("".concat(pt()).concat(vt(e,n,i))).then((function(t){var e,n,o=t.data;o.length>0&&(null===(e=o[0])||void 0===e?void 0:e.lat)&&(null===(n=o[0])||void 0===n?void 0:n.address)&&(s({type:"location_start/setGeocode",geocode:o[0]}),s({type:"notification_control/setAlert",alert:{mode:"info",message:"Aloituspiste asetettu"}}),d())})).catch((function(t){console.warn(t.message)})),o&&ft.get("".concat(pt()).concat(vt(e,n,i))).then((function(t){var e,n,o=t.data;o.length>0&&(null===(e=o[0])||void 0===e?void 0:e.lat)&&(null===(n=o[0])||void 0===n?void 0:n.address)&&(s({type:"location_end/setGeocode",geocode:o[0]}),s({type:"notification_control/setAlert",alert:{mode:"info",message:"P\xe4\xe4tepiste asetettu"}}),d())})).catch((function(t){console.warn(t.message)}))},children:"Aseta"},"".concat(c,"-query"))]),e),c):Object(it.jsx)(ct.a,{id:c,"data-testid":c,variant:"outlined",sx:{"& > :not(style)":{m:1},minWidth:300,maxWidth:800,marginBottom:2,backgroundColor:"rgba(0,0,0,0.05)"},children:Object(it.jsx)(H.a,{children:Object(it.jsx)(bt.a,{icon:Object(it.jsx)(mt.a,{}),label:"Virheelliset m\xe4\xe4ritykset",color:"error",variant:"outlined"})})},c)};function Ot(t,e){var n,o,i,a,r,c,l,s,d,u,m,b,j,p,v,f,g="".concat(null===t||void 0===t||null===(n=t.address)||void 0===n?void 0:n.house_number,", ").concat(null===t||void 0===t||null===(o=t.address)||void 0===o?void 0:o.road,", ").concat((null===t||void 0===t||null===(i=t.address)||void 0===i?void 0:i.city)||(null===t||void 0===t||null===(a=t.address)||void 0===a?void 0:a.town),"::").concat(null===t||void 0===t?void 0:t.lat,",").concat(null===t||void 0===t?void 0:t.lon),O="".concat(null===e||void 0===e||null===(r=e.address)||void 0===r?void 0:r.house_number,", ").concat(null===e||void 0===e||null===(c=e.address)||void 0===c?void 0:c.road,", ").concat((null===e||void 0===e||null===(l=e.address)||void 0===l?void 0:l.city)||(null===e||void 0===e||null===(s=e.address)||void 0===s?void 0:s.town),"::").concat(null===e||void 0===e?void 0:e.lat,",").concat(null===e||void 0===e?void 0:e.lon);return{start:{queryLocation:g,street:null===t||void 0===t||null===(d=t.address)||void 0===d?void 0:d.road,number:null===t||void 0===t||null===(u=t.address)||void 0===u?void 0:u.house_number,municipality:(null===t||void 0===t||null===(m=t.address)||void 0===m?void 0:m.city)||(null===t||void 0===t||null===(b=t.address)||void 0===b?void 0:b.town)},end:{queryLocation:O,street:null===e||void 0===e||null===(j=e.address)||void 0===j?void 0:j.road,number:null===e||void 0===e||null===(p=e.address)||void 0===p?void 0:p.house_number,municipality:(null===e||void 0===e||null===(v=e.address)||void 0===v?void 0:v.city)||(null===e||void 0===e||null===(f=e.address)||void 0===f?void 0:f.town)}}}var ht=function(t){var e=Object(j.c)((function(t){return t.start})),n=Object(j.c)((function(t){return t.end})),o=Object(j.b)();return Object(it.jsxs)("section",{id:t.id,"data-testid":t.id,children:[Object(it.jsx)(gt,{id:"".concat(t.id,".address-form-start"),end:!1,start:!0}),Object(it.jsx)(gt,{id:"".concat(t.id,".address-form-end"),end:!0,start:!1}),!1,Object(it.jsx)(M.a,{id:"".concat(t.id,".generate-route"),"data-testid":"".concat(t.id,".generate-route"),variant:"outlined",size:"medium",color:"secondary",disabled:!(null!==e.geocode&&e.geocode.hasOwnProperty("lat"))||!(null!==n.geocode&&n.geocode.hasOwnProperty("lat")),onClick:function(t){var i=Ot(e.geocode,n.geocode);console.warn(i),function(t){var e=[],n=JSON.parse(localStorage.getItem("".concat(R.a,".routes")));null!==n&&n.length>0&&n.map((function(t){t.hasOwnProperty("latitude")&&e.append(t)})),e=[].concat(Object(_.a)(e),[t]),localStorage.setItem("".concat(R.a,".routes"),JSON.stringify(e))}(i),o({type:"route_control/addRoute",route:i}),o({type:"notification_control/setAlert",alert:{mode:"success",message:"Reitti luotu"}}),o({type:"location_end/resetEnd"}),o({type:"location_start/resetStart"})},children:"Luo reitti"})]})},yt=function(t){var e=Object(j.c)((function(t){return t.end})),n=Object(j.c)((function(t){return t.start}));return Object(it.jsxs)("section",{id:t.id,"data-testid":t.id,children:[n.geocode?Object(it.jsxs)("p",{children:[n.geocode.latitude,",",n.geocode.longitude]}):Object(it.jsx)("p",{children:"L\xe4ht\xf6piste puuttuu"}),e.geocode?Object(it.jsxs)("p",{children:[e.geocode.latitude,",",e.geocode.longitude]}):Object(it.jsx)("p",{children:"P\xe4\xe4tepiste puuttuu"})]})},xt=function(t){return Object(it.jsx)("section",{id:t.id,"data-testid":t.id,children:Object(it.jsxs)(W.c,{children:[Object(it.jsx)(W.a,{path:"/planning",children:Object(it.jsx)(ht,{id:"".concat(t.id,".planning")})}),Object(it.jsx)(W.a,{path:"/details",children:Object(it.jsx)(yt,{id:"".concat(t.id,".geocode")})}),Object(it.jsx)(W.a,{exact:!0,path:"/",children:Object(it.jsx)(at,{id:"".concat(t.id,".routes")})})]})})},St=function(t){var e=t.id;return Object(it.jsxs)("nav",{id:e,"data-testid":e,style:{display:"inline-flex",alignItems:"center"},children:[Object(it.jsx)(H.a,{orientation:"vertical",variant:"middle",color:J.a.A700,flexItem:!0}),Object(it.jsx)(M.a,{to:"/",sx:{margin:1},variant:"outlined",component:F.b,children:"Reitit"}),Object(it.jsx)(H.a,{orientation:"vertical",variant:"middle",color:J.a.A700,flexItem:!0}),Object(it.jsx)(M.a,{to:"/details",sx:{margin:1},variant:"outlined",component:F.b,children:"Pistetiedot"}),Object(it.jsx)(H.a,{orientation:"vertical",variant:"middle",color:J.a.A700,flexItem:!0}),Object(it.jsx)(M.a,{to:"/planning",sx:{margin:1},variant:"outlined",component:F.b,children:"Reittisuunnittelu"}),Object(it.jsx)(H.a,{orientation:"vertical",variant:"middle",color:J.a.A700,flexItem:!0})]})},It={street:"soittilanm\xe4ki",number:"6",municipality:"espoo"},_t={street:"lapinlahdenkatu",number:"16",municipality:"helsinki"},kt=function(t){var e,n,o,i=It,a=_t,r=Object(j.c)((function(t){return t.notification})).alert,c=Object(j.b)();Object(l.useEffect)((function(){var t=!1;ft.get("".concat(pt()).concat(vt(i.street,i.number,i.municipality))).then((function(t){var e,o,i=t.data;i.length>0&&(null===(e=i[0])||void 0===e?void 0:e.lat)&&(null===(o=i[0])||void 0===o?void 0:o.address)&&(n=i[0])})).catch((function(t){console.warn(t.message)})),ft.get("".concat(pt()).concat(vt(a.street,a.number,a.municipality))).then((function(t){var e,n,i=t.data;i.length>0&&(null===(e=i[0])||void 0===e?void 0:e.lat)&&(null===(n=i[0])||void 0===n?void 0:n.address)&&(o=i[0])})).catch((function(t){console.warn(t.message)}));var e=Ot(n,o);c({type:"route_control/setDefault",route:e});var r=JSON.parse(localStorage.getItem("".concat(R.a,".routes")))||null;null!==r&&r.length>0&&(c({type:"route_control/setRoutes",routes:r}),t=!0),t?(c({type:"notification_control/setAlert",alert:{mode:"success",message:"Oletusreitti luotu"}}),setTimeout((function(){c({type:"notification_control/setAlert",alert:{message:"Reitit palautettu"}})}),3e3)):routeSet||c({type:"notification_control/setAlert",alert:{mode:"success",message:"Oletusreitti luotu"}})}),[i,a,n,o]);var d=Object(it.jsxs)(s.a.Fragment,{children:[Object(it.jsx)(M.a,{color:"secondary",size:"small",onClick:function(){return c({type:"notification_control/resetAlert"})},children:"UNDO"}),Object(it.jsx)(z.a,{size:"small","aria-label":"close",color:"inherit",onClick:function(){return c({type:"notification_control/resetAlert"})},children:Object(it.jsx)(E.a,{fontSize:"small"})})]});return Object(it.jsx)("article",{id:t.id,"data-testid":t.id,children:Object(it.jsx)(F.a,{children:Object(it.jsxs)(T.a,{theme:Object(q.a)({palette:{primary:{main:G.a.A700},secondary:{main:J.a.A700},neutral:{main:V.a.A700}}}),children:[Object(it.jsxs)(L.a,{variant:"h5",children:["StopOver - ",t.ver]}),Object(it.jsx)(St,{id:"".concat(t.id,".navigation")}),Object(it.jsx)(xt,{id:"".concat(t.id,".content")}),Object(it.jsx)(N.a,{id:"".concat(t.id,".snack"),open:null!==r,autoHideDuration:6e3,onClose:function(){return c({type:"notification_control/resetAlert"})},message:null!==(e=null===r||void 0===r?void 0:r.message)&&void 0!==e?e:"testi",action:d})]})})})};u.a.render(Object(it.jsx)(s.a.StrictMode,{children:Object(it.jsx)(j.a,{store:D,children:Object(it.jsx)(b.a,{client:C,children:Object(it.jsx)(kt,{id:R.a,ver:R.b})})})}),document.getElementById("root")),m()},54:function(t){t.exports=JSON.parse('{"a":"rff.app.stopover","b":"0.4.3"}')}},[[190,1,2]]]);
//# sourceMappingURL=main.812ca4a0.chunk.js.map